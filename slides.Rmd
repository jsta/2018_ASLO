---
title: Does Lake and Stream Connectivity
subtitle: Control Phosphorus Retention in Lakes?
author: Joseph Stachelek and Patricia Soranno
institute: Michigan State University
date: "2018\\ June"
bibliography: test.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.path = "figures/", dpi=300, fig.height=3, fig.width=3)
```

```{r read_chunks, echo=FALSE}
knitr::read_chunk("scripts/distribution_cartoons.R")
knitr::read_chunk("scripts/nes_map.R")
```

## P retention is important and well-studied

* Figure

* Lit citations

## P retention is not just about water residence time

\vspace{-2em}

\begincols

\hfill\column{0.48\textwidth}

\begin{figure}
\includegraphics[width=7cm]{figures/conceptual_p-cycle_pt1.png}
\end{figure}

\hfill\column{0.52\textwidth}

```{r milstead, echo=FALSE, warning=FALSE, fig.width=3, fig.height=2.5}
library(ggplot2)

dt_path <- paste0("~/Documents/Science/Dissertation/Analysis/_episodes_rmd/misc", 
                  "/milstead_x_lagos.rds")

test3 <- readRDS(dt_path)

levels(test3$lakeconnectivity)[1:2] <- c("Secondary", "Primary")
test3 <- test3[test3$hrt > 0,] 
test3 <- test3[test3$AreaSqKm > 0.04,] # rm less than 4 ha
test3 <- test3[!is.na(test3$lakeconnectivity),]

yr_labels <- c("1e-07", "1e-05", 
               as.character(10/365), 
               as.character(2/12),
               "2", "10")

format_labels <- function(x, mult_factor){
  gsub("\\.+$", "\\1", gsub("0+$", "\\1",
    trimws(format(round(as.numeric(x), 6) * 
      mult_factor, scientific = FALSE)), perl = TRUE))
  }

day_labels   <- ceiling(as.numeric(
  format_labels(yr_labels, 365)) / 10) * 10
minute_labels  <- ceiling(as.numeric(
  format_labels(yr_labels, 365 * 24 * 60)) / 10) * 10
month_labels  <- round(as.numeric(
  format_labels(yr_labels, 12)), 0)

mixed_labels <- paste0(
      c(minute_labels[1:2], day_labels[3], month_labels[4], yr_labels[5:6]), 
      c(" min", " min", " days", " months", " years", " years"))

quants <- exp(quantile(log(test3[!is.na(test3$lakeconnectivity), "hrt"])))

ggplot(data = test3, 
    aes(x = hrt, y = Rp)) + geom_point(size = 0.9) +
  scale_x_log10(labels = mixed_labels, 
    breaks = as.numeric(yr_labels), limits = c(1 / 365, 11)) +
  stat_smooth(method = "glm", method.args = list(family = "binomial"), 
              se = TRUE) +
  scale_color_brewer(palette = "Set1") +
  cowplot::theme_cowplot() + 
  theme(legend.position = "none", 
        legend.title = element_blank(), 
        legend.text = element_text(),
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 9), 
        axis.title = element_text(size = 10)) +
  xlab("Residence Time") +
  ylab("P Retention")
```

\stopcols

## What are some other potential controls on P retention?

\includegraphics[width=0.8\textwidth]{figures/conceptual_p-cycle.png}

## Connectivity is a catchall term

\includegraphics[width=0.9\textwidth]{figures/conny_metric_key1.png}
\includegraphics[width=0.9\textwidth]{figures/conny_metric_key2.png}

## Scale explanation

\includegraphics[width=0.6\textwidth]{figures/iws_nws.pdf}

## Does connectivity of lakes and their watersheds influence lake phosphorus retention?  

What is the relative importance of \alert{different connectivity types} in determining lake P retention and \alert{what spatial extents are most important} for connectivity and P retention?

## Methods

\vspace{-1em}

\begincols

\hfill\column{0.5\textwidth}

```{r nes_map, echo=FALSE, message=FALSE, warning=FALSE}

```

\hfill\column{0.5\textwidth}

```{r distribution_cartoons, echo=FALSE, message=FALSE, warning=FALSE}

```

\stopcols

## Finding 1

\vspace{-1em}

\includegraphics[width=0.75\textwidth]{figures/k_viz-1.pdf}

## Finding 2

## Conclusion

\includegraphics[width=0.8\textwidth]{figures/conceptual_p-cycle.png}

## Implications

* Watershed controls on P delivery to lakes

* WS:LA ratio

## Fonts and spacing

The document uses the \alert{Google Crosscore} family

Main body
: Tinos or Arimo

Maths
: $\text{Tinos}$

Code
: `Cousine`

The linespread value has been increased to about $1.3$

## Serif font theme

The default font theme is sans serif. You can change the `template/pl.tex` first line to:

~~~ latex
@@ -1,4 +1,4 @@
-\documentclass[11pt, compress, aspectratio=1610]{beamer}
+\documentclass[11pt, compress, aspectratio=1610, serif]{beamer}

\usetheme{pl}
~~~

## Colors

The structure elements are in green, inline code is in `blue`, and alerted text
in \alert{orange}.

The background is off-white: it will *look* like it's white, but with less
eyestrain.

The foreground is not-quite-black either.

## Tables

| PID   | COMMAND        | %CPU | TIME     | #TH |
|:------|:---------------|-----:|:---------|:---:|
| 25645 | `top`          | 16.3 | 00:02.03 | 1/1 |
| 25642 | `bash`         |  0.0 | 00:00.01 |  1  |
| 25641 | `login`        |  0.0 | 00:00.02 |  2  |
| 25634 | `mdworker`     |  0.0 | 00:00.07 |  3  |
| 25624 | `mdworker`     |  0.0 | 00:00.14 |  4  |
| 25591 | `mdworker`     |  0.0 | 00:00.14 |  3  |
| 25571 | `com.apple.iC` |  0.0 | 00:00.31 |  5  |
| 25414 | `installd`     |  0.0 | 00:00.52 |  2  |
| 25366 | `com.apple.We` |  0.0 | 00:00.07 |  4  |

## PGF Plots

\centering
\begin{tikzpicture}
  \begin{axis}[width=0.8\textwidth,height=0.6\textheight,grid=major,xlabel=$x$,ylabel=$f(x)$]
  \addplot {-x^5 - 242};
  \addlegendentry{model}
  \addplot coordinates { (-4.77778,2027.60977) (-3.55556,347.84069) (-2.33333,22.58953) (-1.11111,-493.50066) (0.11111,46.66082) (1.33333,-205.56286) (2.55556,-341.40638) (3.77778,-1169.24780) (5.00000,-3269.56775) };
  \addlegendentry{estimate}
  \end{axis}
\end{tikzpicture}

## Maths

The Input family of fonts has some support for Greek and mathematical symbols:

$$
\frac{1}{N}\frac{\text{d}}{\text{d}t}N = N\left(r-\alert{\alpha N}\right)
$$

You can use `\alert` within math blocks.

## Code highlighting

There is a customized color scheme for code highlighting.

~~~ julia
Î± = 2.0
b, c = "abc", 'c'
# This code does nothing (useful)
for i in 1:10
  rand()
  @elapsed println("i:\t$i")
end
~~~

We can also use \alert{unicode characters}.

## Background image

The background image is generated from the `makebackground.jl` file. It's the
k-nearest neighbour graph of a series of random points.

The file is `background.png` -- it can be replaced by any file \alert{as long
as} the replacement file is in the 16:10 format (for example, a 1600 $\times$
1000 image).

# Specific commands

## Cropped images

\begincols
\column{0.68\textwidth}

The `roundpicture` command will display a picture, resized to fit into a circle:

~~~ latex
\roundpicture{images/nb.png}{Optional text}
~~~

Note that the image \alert{must} be a square.

\hfill\column{0.28\textwidth}

\roundpicture{images/nb.png}{}

\stopcols
